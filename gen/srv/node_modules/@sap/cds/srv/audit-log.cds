service AuditLogService {

  // Log read access to sensitive personal data
  event dataAccessLog {
    accesses         : array of Access;
    // accessFilters : array of KeyValuePair;
  };

  // Log changes to personal data
  event dataModificationLog : {
    modifications : array of DataModification;
  };

  // config change
  event configChangeLog : {
    action         : String @assert.range enum {
      Create;
      Update;
      Delete
    };
    // success     : Boolean;
    configurations : array of ConfigChange;
  };

  // security message
  event securityLog : {
    action : String;
    data   : String;
  };

}

// types

define type KeyValuePair {
  keyName : String;
  value   : String;
};

define type DataObject {
  type : String;
  id   : array of KeyValuePair;
};

define type DataSubject {
  type : String;
  id   : array of KeyValuePair;
  role : String;
};

define type Attribute {
  name : String;
};

define type Attachment {
  id   : String;
  name : String;
};

define type Access {
  dataObject  : DataObject;
  dataSubject : DataSubject;
  attributes  : array of Attribute;
  attachments : array of Attachment;
};

define type ChangedAttribute {
  name     : String;
  oldValue : String;
  newValue : String;
};

define type DataModification {
  dataObject  : DataObject;
  dataSubject : DataSubject;
  action      : String @assert.range enum {
    Create;
    Update;
    Delete;
  };
  attributes  : array of ChangedAttribute;
}

define type ConfigChange {
  dataObject : DataObject;
  attributes : array of ChangedAttribute;
};
