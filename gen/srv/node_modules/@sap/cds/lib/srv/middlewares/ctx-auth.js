const cds = require ('../../index')

/**
 * Propagates auth results to cds.context
 */
module.exports = ()=> function cds_context_auth (req, res, next) {
  const ctx = cds.context
  ctx.user = req.user
  ctx.tenant = req.tenant || ctx.user?.tenant
  next()
}
