const compile = require ('../cdsc')

module.exports = function cds_compile_for_odata (csn,_o) {
  if ('_4odata' in csn) return csn._4odata
  let o = compile._options.for.odata(_o) //> required to inspect .sql_mapping below
  let dsn = compile.for.odata (csn,o)
  if (o.sql_mapping) dsn['@sql_mapping'] = o.sql_mapping //> compat4 old Java stack
  Object.defineProperty (csn, '_4odata', {value:dsn})
  Object.defineProperty (dsn, '_4odata', {value:dsn})
  return dsn
}
