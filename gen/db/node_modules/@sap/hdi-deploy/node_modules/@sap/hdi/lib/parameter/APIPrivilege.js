'use strict';

const TableRow = require('./TableRow.js');
const parameterCheck = require('./parameterCheck.js');
/**
 * An API Privilege describes which privilege to grant and to whom to grant the privilege.
 * @extends TableRow
 */
class APIPrivilege extends TableRow {
  /**
   * @param {string} privilegeName The name of the privilege to grant.
   * @param {string} objectName The object (part of the API) that you want to grant privileges on.
   * @param {string} principalSchemaName If the principalName is a schema-local role, this specifies the schema.
   * @param {string} principalName Name of the grantee (either a user or role).
   */
  constructor(privilegeName, objectName, principalSchemaName, principalName) {
    if (principalSchemaName === null) {
      principalSchemaName = '';
    }

    const entries = [privilegeName, objectName, principalSchemaName, principalName];

    entries.forEach((v) => parameterCheck.isString(v));

    super(entries);
  }

  /**
   * Returns the field list, this will be inserted into a sql insert statement to fill the correct fields of a helper table.
   * @example let sql = `insert into ${schema}.${table} (${this.getFieldList()}) values (${this.getPlaceholderList()})`;
   * @returns {string} Names of the fields in the table in the form of a single string separated by commas.
   */
  getFieldList() {
    return 'PRIVILEGE_NAME, OBJECT_NAME, PRINCIPAL_SCHEMA_NAME, PRINCIPAL_NAME';
  }

  /**
   * Returns the placeholder list, this will be inserted into a sql insert statement to fill the correct fields of a helper table.
   * @example let sql = `insert into ${schema}.${table} (${this.getFieldList()}) values (${this.getPlaceholderList()})`;
   * @returns {string} Placeholder to insert into a sql statement, a single ? for each field.
   */
  getPlaceholderList() {
    return '?, ?, ?, ?';
  }
}

module.exports = APIPrivilege;
